(function(a){a.fn.csTicker=function(w){function m(c){a(c).find("li").css("width",a(c).outerWidth()-a(c).find(".csTicker__title").outerWidth());a(c).find("ul").css("left",a(c).find(".csTicker__title").outerWidth());a(c).find(".wrapper").css("height",a(c).find("li").outerHeight());a(window).resize(function(){var l=a(c).find(".csTicker__title").outerWidth();a(c).find("li").css("width",a(c).outerWidth()-l);var h=a(c).find("ul").children("li").eq(x).position().left;var f=h-l;a(c).find("ul").css("left",-f);a(c).find(".wrapper").css("height",a(c).find("li").outerHeight())})}function g(l){titleWidth=a(l).find(".csTicker__title").outerWidth();buttonWidth=a(l).find(".csTicker__buttons").outerWidth();var f=a(l).parent().innerWidth();var c;if(f>768){c=3}else{if(f>480){c=2}else{c=1}}a(l).find("li").css("width",a(l).outerWidth()/c);var h=a(l).find("li").map(function(){return a(this).height()}).get();a(l).find(".wrapper").css("height",Math.max.apply(null,h)+20);a(l).find("ul").animate({left:"-"+a(l).find("ul").children("li").eq(x).position().left},w.speed,"swing");a(window).resize(function(){var s;var n=a(l).parent().innerWidth();if(n>768){s=3}else{if(n>480){s=2}else{s=1}}a(l).find("li").css("width",a(l).outerWidth()/s);var t=a(l).find("li").map(function(){return a(this).height()}).get();a(l).find(".wrapper").css("height",Math.max.apply(null,t)+20);a(l).find("ul").animate({left:"-"+a(l).find("ul").children("li").eq(x).position().left},w.speed,"swing")})}function p(c){setInterval(function(){k("next",c)},w.delay)}function k(h,f,c){if(!d||c){switch(h){case"next":if(x<a(f).find("li").length-1){switch(w.tickerMode){case"mini":a(f).find("ul").animate({left:"-"+(a(f).find("ul").children("li").eq(x+1).position().left-a(f).find(".csTicker__title").outerWidth())},w.speed,"swing");break;case"horizontal":a(f).find("ul").animate({left:"-"+a(f).find("ul").children("li").eq(x+1).position().left},w.speed,"swing");break;default:a(f).find("ul").animate({top:"-"+(a(f).find("ul").children("li").eq(x+1).position().top-a(f).find(".csTicker__title").outerHeight())},w.speed,"swing");break}x++}else{switch(w.tickerMode){case"mini":a(f).find("ul").animate({left:a(f).find(".csTicker__title").outerWidth()},w.speed,"swing");break;case"horizontal":a(f).find("ul").animate({left:0},w.speed,"swing");break;default:a(f).find("ul").animate({top:a(f).find(".csTicker__title").outerHeight()},w.speed,"swing");break}x=0}break;case"prev":if(x>1){switch(w.tickerMode){case"mini":a(f).find("ul").animate({left:"-"+(a(f).find("ul").children("li").eq(x-1).position().left-a(f).find(".csTicker__title").outerWidth())},w.speed,"swing");break;case"horizontal":a(f).find("ul").animate({left:"-"+a(f).find("ul").children("li").eq(x-1).position().left},w.speed,"swing");break;default:a(f).find("ul").animate({top:"-"+(a(f).find("ul").children("li").eq(x-1).position().top-a(f).find(".csTicker__title").outerHeight())},w.speed,"swing");break}x--}else{switch(w.tickerMode){case"mini":a(f).find("ul").animate({left:a(f).find(".csTicker__title").outerWidth()},w.speed,"swing");break;case"horizontal":a(f).find("ul").animate({left:0},w.speed,"swing");break;default:a(f).find("ul").animate({top:a(f).find(".csTicker__title").outerHeight()},w.speed,"swing");break}x=0}break}}}var e={tickerMode:"vertical",customCSS:false,delay:5000,speed:300,autoAnimate:true,buttons:true,highlightFeatured:true,stickyFeature:false,tickerTitle:false,contentFeed:false,feedCount:10,truncateAt:100,linkTarget:"_blank",addEllipsis:false,pauseOnHover:true,backgroundColour:false,titleColour:false,titleTextColour:false};var w=a.extend({},e,w);var b;var j=a(this).attr("id");var x=0;var d=false;if(w.customCSS){a("<link/>",{rel:"stylesheet",type:"text/css",href:customCSS}).appendTo("head")}var v=this;if(w.contentFeed){var q;a.ajax({type:"GET",url:document.location.protocol+"//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=1000&callback=?&q="+encodeURIComponent(w.contentFeed),dataType:"json",error:function(){},success:function(f){q=f.responseData.feed.entries;var c="<ul>";a(q).each(function(){var l=a(this).html();c+="<li>";if(a(this).data("img")){c+='<div class="col"><img src="'+a(this).attr("img")+'"/>';c+='</div><div class="col">'}c+='<p class="h3"><a target="'+w.linkTarget+'" href="'+a(this).attr("link")+'">'+a(this).attr("title")+"</a></p>";if(w.truncateAt){var h=a(this).attr("contentSnippet").substr(0,w.truncateAt);h=h.substr(0,Math.min(h).length,h.lastIndexOf(" "))}else{var h=a(this).attr("contentSnippet")}if(w.addEllipsis){h+="..."}c+="<p>"+h+"</p>";c+='<p class="small">'+a(this).attr("author")+" - "+a(this).attr("publishedDate")+"</p>";if(a(this).data("img")){c+="</div>"}c+="</li>"});a(v).append(c+"</ul>").find(".csTicker__spinner").remove();m(v)}});a(this).append('<div class="csTicker__spinner"><img src="img/spinner.gif" /></div>')}if(w.tickerTitle){a(this).prepend('<div class="csTicker__title">'+w.tickerTitle+"</div>")}a(this).find("ul").wrap('<div class="wrapper"></div>');if(w.buttons){a(this).prepend('<div class="csTicker__buttons"><div class="buttons__prev-button"></div><div class="buttons__next-button"></div></div>')
}if(!w.contentFeed){a(this).find("li").each(function(){var h=a(this).html();if(w.highlightFeatured&&a(this).data("featured")==true){a(this).addClass("featured")}var f="";if(a(this).data("img")){f+='<div class="col">';f+='<img src="'+a(this).data("img")+'"/>';f+='</div><div class="col">'}if(a(this).data("title")){f+='<p class="h3"><a target="'+w.linkTarget+'" href="'+a(this).data("link")+'">'+a(this).data("title")+"</a></p>"}if(w.truncateAt){var c=h.substr(0,w.truncateAt);c=c.substr(0,Math.min(c).length,c.lastIndexOf(" "))}else{var c=h}if(w.addEllipsis){c+="..."}f+="<p>"+c+"</p>";if(a(this).data("meta")){f+='<p class="small">'+a(this).data("meta")+"</p>"}if(a(this).data("img")){f+="</div>"}a(this).empty().append(f)})}a(this).addClass("csTicker");switch(w.tickerMode){case"horizontal":a(this).addClass("csTicker--horizontal");g(this);break;case"mini":a(this).addClass("csTicker--mini");m(this);break;case"grid":a(this).addClass("csTicker--grid");break;default:break}if(w.backgroundColour){a(this).css("background",w.backgroundColour)}if(w.titleColour){a(this).find(".csTicker__title").css("background",w.titleColour)}if(w.titleTextColour){a(this).find(".csTicker__title").css("color",w.titleTextColour)}if(w.pauseOnHover){a(v).mouseenter(function(){d=true}).mouseleave(function(){d=false})}return this.each(function(){var c=a(this);if(w.autoAnimate){p(c)}if(w.buttons){a(this).find(".buttons__prev-button").click(function(){k("prev",c,true)});a(this).find(".buttons__next-button").click(function(){k("next",c,true)})}})}})(jQuery);